<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.4.2">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/neural.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/neural.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"cq-yangxh.github.io","root":"/","scheme":"Gemini","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"./public/search.json"};
  </script>

  <meta name="description" content="Reliable EMG decomposition technique is very importance for understanding the neurophysiology, diagnosis and tracking the progress of motor neuron diseases or neuromuscular disorders [11], [26], [29].">
<meta property="og:type" content="article">
<meta property="og:title" content="Enhanced Dynamic Surface EMG Decomposition Using the Non-Negative Matrix Factorization and Three-Dimensional Motor Unit Localization">
<meta property="og:url" content="https://cq-yangxh.github.io/2024/11/17/%E8%AE%BA%E6%96%87/Dynamic/Enhanced-Dynamic-Surface-EMG-Decomposition-Using-the-Non-Negative-Matrix-Factorization-and-Three-Dimensional-Motor-Unit-Localization/index.html">
<meta property="og:site_name" content="Xinhao&#39;s notebook">
<meta property="og:description" content="Reliable EMG decomposition technique is very importance for understanding the neurophysiology, diagnosis and tracking the progress of motor neuron diseases or neuromuscular disorders [11], [26], [29].">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2024-11-17T12:15:07.000Z">
<meta property="article:modified_time" content="2025-01-16T07:37:40.328Z">
<meta property="article:author" content="Xinhao">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="https://cq-yangxh.github.io/2024/11/17/%E8%AE%BA%E6%96%87/Dynamic/Enhanced-Dynamic-Surface-EMG-Decomposition-Using-the-Non-Negative-Matrix-Factorization-and-Three-Dimensional-Motor-Unit-Localization/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'en'
  };
</script>

  <title>Enhanced Dynamic Surface EMG Decomposition Using the Non-Negative Matrix Factorization and Three-Dimensional Motor Unit Localization | Xinhao's notebook</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">Xinhao's notebook</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>Tags</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>Categories</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>Search
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="Searching..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://cq-yangxh.github.io/2024/11/17/%E8%AE%BA%E6%96%87/Dynamic/Enhanced-Dynamic-Surface-EMG-Decomposition-Using-the-Non-Negative-Matrix-Factorization-and-Three-Dimensional-Motor-Unit-Localization/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.png">
      <meta itemprop="name" content="Xinhao">
      <meta itemprop="description" content="无限进步">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Xinhao's notebook">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          Enhanced Dynamic Surface EMG Decomposition Using the Non-Negative Matrix Factorization and Three-Dimensional Motor Unit Localization
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2024-11-17 20:15:07" itemprop="dateCreated datePublished" datetime="2024-11-17T20:15:07+08:00">2024-11-17</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2025-01-16 15:37:40" itemprop="dateModified" datetime="2025-01-16T15:37:40+08:00">2025-01-16</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E8%AE%BA%E6%96%87/" itemprop="url" rel="index"><span itemprop="name">论文</span></a>
                </span>
                  , 
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E8%AE%BA%E6%96%87/Dynamic/" itemprop="url" rel="index"><span itemprop="name">Dynamic</span></a>
                </span>
            </span>

          
            <span class="post-meta-item" title="Views" id="busuanzi_container_page_pv" style="display: none;">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">Views: </span>
              <span id="busuanzi_value_page_pv"></span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <p>Reliable EMG decomposition technique is very importance for understanding the neurophysiology, diagnosis and tracking the progress of motor neuron diseases or neuromuscular disorders [11], [26], [29]. In this article, a novel sEMG decomposition algorithm specifically suitable for dynamic contraction was proposed. By combining the NMF and LMMSE, the EFT was firstly extracted from the eigenvector matrix. Then the firing instants of each EFT were classified into MUs according to their specific 3D space positions.</p>
<span id="more"></span>
<h1 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h1><ul>
<li>The EFT was firstly extracted using LMMSE from the eigenvector matrix constructed using the non-negative matrix factorization (NMF). Then the firing instants of EFT were classified into MUs according to their three-dimensional (3D) space position. The performance of this approach was evaluated on simulated and experimentally collected sEMG signal. In the simulation, the number of decomposedMU and the true positiverate(TPR)were employed as performance metrics of the proposed approach; while for the experimental data, due to the lack of ground truth, <mark>the two-source method and decompose- synthesize-decomposecompare (DSDC) method were adopted.  </mark></li>
</ul>
<p>如何在实验数据上对提出的算法进行验证？</p>
<ul>
<li><p>双源法：In the two-source approach, the even and odd numbered electrodes were classified into two groups. The motor units decomposed based on the two sets of measurements were compared in terms of firing instants. The principle of two-source method was that the more the same firing instants were found in two groups of signals, the better the effectiveness of the algorithm was.</p>
<blockquote>
<p>B. Mambrito and D. Luca, “A technique for the detection, decompositionand analysis of the EMG signal” </p>
</blockquote>
</li>
<li><p>DSDC：In this approach, the collected sEMG signals was firstly decomposed into EFT from which the MUAP was constructed. Then the summation of all of the MUAPs was added Gaussian noise to simulate the noise-contaminated signal. Finally, the performance of the decomposition algorithm was evaluated by how well the MUs extracted from experimental sEMG signals match the MUs exacted from the synthesized signals. The principle of DSDC verificationwas that thereconstructed and decomposition firing instants were the same as possible.</p>
<blockquote>
<p>C. Zhang et al., “Three dimensional innervation zone imaging in spastic muscles of stroke survivors”  </p>
<p>D. Luca and P. Contessa, “Hierarchical control of motor units in voluntarycontractions” </p>
</blockquote>
</li>
</ul>
<h1 id="Algorithm"><a href="#Algorithm" class="headerlink" title="Algorithm"></a>Algorithm</h1><ol>
<li>首先是对信号矩阵进行 NMF 分解，得到矩阵 W</li>
<li>利用 W 和 LMMSE 对 EFT 进行估计</li>
<li>重复得到新的 EFT</li>
<li>利用 3DSP 对 EFT 进行分类，得到 MUAPT（包含两个步骤）</li>
</ol>
<h1 id="Questions"><a href="#Questions" class="headerlink" title="Questions"></a>Questions</h1><ul>
<li><p>NMF要求观测矩阵非负： $ \bar{x}^T=W_{n \times r}*V_{r \times Lm} $ ，那么这个观测矩阵是如何保证非负的呢？</p>
</li>
<li><p>最小二乘法如何利用托普利兹矩阵求解波形？</p>
<blockquote>
<p>toeplitz: T = toeplitz(c,r) - 托普利茨矩阵。此 MATLAB 函数返回非对称托普利茨矩阵，其中 c 作为第一列，r 作为第一行。如果 c 和 r 的首个元素不同，toeplitz 将发出警告并使用列元素作为对角线。</p>
</blockquote>
</li>
</ul>
<h1 id="最小二乘法求解波形"><a href="#最小二乘法求解波形" class="headerlink" title="最小二乘法求解波形"></a>最小二乘法求解波形</h1><p>优化目标的解析解：</p>
<script type="math/tex; mode=display">
A_{(q)}^*=(\widehat{S}^T\widehat{S})^{-1}\widehat{S}^Tx_k</script><p>其中 $\widehat{S}$ 是托普利兹矩阵，托普利兹矩阵能够把卷积转换成线性相乘，所以托普利兹矩阵满足：</p>
<script type="math/tex; mode=display">
\widehat{S}A_{(q)}=A_{(q)}*S_{(q)}</script><p>所以求一个发放序列的波形的代码如下：</p>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">S; <span class="comment">% the firing trains extracted from Mu.MUpulse (MU index X samples)</span></span><br><span class="line">[n,T] = <span class="built_in">size</span>(S);</span><br><span class="line">yanchi = <span class="built_in">fix</span>(<span class="number">0.4</span>*wavelength); <span class="comment">% 把 wavelength 乘以系数之后向零取整</span></span><br><span class="line">xt = <span class="built_in">zeros</span>(n*wavelength,T); <span class="comment">% n*wavelength X samples</span></span><br><span class="line"><span class="keyword">for</span> <span class="built_in">j</span> = <span class="number">1</span>:n</span><br><span class="line">    xt((<span class="built_in">j</span><span class="number">-1</span>)*wavelength+<span class="number">1</span>:<span class="built_in">j</span>*wavelength,:) = <span class="built_in">toeplitz</span>([S(<span class="built_in">j</span>,(yanchi+<span class="number">1</span>):<span class="number">-1</span>:<span class="number">1</span>),<span class="built_in">zeros</span>(<span class="number">1</span>,(wavelength-yanchi<span class="number">-1</span>))],</span><br><span class="line">    [S(<span class="built_in">j</span>,(yanchi+<span class="number">1</span>):<span class="keyword">end</span>),<span class="built_in">zeros</span>(<span class="number">1</span>,yanchi)]);</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line">CC = pinv(xt&#x27;);</span><br><span class="line">W = CC*x&#x27;;</span><br></pre></td></tr></table></figure>
<p><strong>这个延迟因子该如何确定？</strong> 开源代码中取的 0.4，</p>

    </div>

    
    
    

      <footer class="post-footer">

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2024/11/08/%E8%AE%BA%E6%96%87/Dynamic/Robust-Identification-of-Motor-Unit-Discharges-From-High-Density-Surface-EMG-in-Dynamic-Muscle-Contractions-of-the-Tibialis-Anterior/" rel="prev" title="Robust Identification of Motor Unit Discharges From High-Density Surface EMG in Dynamic Muscle Contractions of the Tibialis Anterior">
      <i class="fa fa-chevron-left"></i> Robust Identification of Motor Unit Discharges From High-Density Surface EMG in Dynamic Muscle Contractions of the Tibialis Anterior
    </a></div>
      <div class="post-nav-item">
    <a href="/2025/01/17/%E8%AE%A1%E7%AE%97%E6%9C%BA/boost%E9%85%8D%E7%BD%AE/" rel="next" title="boost配置">
      boost配置 <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#Introduction"><span class="nav-text">Introduction</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Algorithm"><span class="nav-text">Algorithm</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Questions"><span class="nav-text">Questions</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E6%9C%80%E5%B0%8F%E4%BA%8C%E4%B9%98%E6%B3%95%E6%B1%82%E8%A7%A3%E6%B3%A2%E5%BD%A2"><span class="nav-text">最小二乘法求解波形</span></a></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Xinhao"
      src="/images/avatar.png">
  <p class="site-author-name" itemprop="name">Xinhao</p>
  <div class="site-description" itemprop="description">无限进步</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">96</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">15</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">27</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/CQ-yangxh" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;CQ-yangxh" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
  </div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2025</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Xinhao</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Gemini</a>
  </div>


    <script async src="//dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>


        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
</div>








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  




  
<script src="/js/local-search.js"></script>













  

  
      

<script>
  if (typeof MathJax === 'undefined') {
    window.MathJax = {
      loader: {
        source: {
          '[tex]/amsCd': '[tex]/amscd',
          '[tex]/AMScd': '[tex]/amscd'
        }
      },
      tex: {
        inlineMath: {'[+]': [['$', '$']]},
        tags: 'ams'
      },
      options: {
        renderActions: {
          findScript: [10, doc => {
            document.querySelectorAll('script[type^="math/tex"]').forEach(node => {
              const display = !!node.type.match(/; *mode=display/);
              const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display);
              const text = document.createTextNode('');
              node.parentNode.replaceChild(text, node);
              math.start = {node: text, delim: '', n: 0};
              math.end = {node: text, delim: '', n: 0};
              doc.math.push(math);
            });
          }, '', false],
          insertedScript: [200, () => {
            document.querySelectorAll('mjx-container').forEach(node => {
              let target = node.parentNode;
              if (target.nodeName.toLowerCase() === 'li') {
                target.parentNode.classList.add('has-jax');
              }
            });
          }, '', false]
        }
      }
    };
    (function () {
      var script = document.createElement('script');
      script.src = '//cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js';
      script.defer = true;
      document.head.appendChild(script);
    })();
  } else {
    MathJax.startup.document.state(0);
    MathJax.texReset();
    MathJax.typeset();
  }
</script>

    

  

</body>
</html>
